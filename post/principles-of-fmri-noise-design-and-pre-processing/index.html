<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Principles of fMRI--Noise, Design and Pre-processing | love and share</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://yaogzblog.github.io/sharing.github.io//favicon.ico?v=1595233627547">
<link rel="stylesheet" href="https://yaogzblog.github.io/sharing.github.io//styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="Artifacts and Noise
Sourse of noise

Thermal motion(热运动) of free electrons in system.
Gradient and magnetic field instab..." />
    <meta name="keywords" content="" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://yaogzblog.github.io/sharing.github.io/">
        <img src="https://yaogzblog.github.io/sharing.github.io//images/avatar.png?v=1595233627547" class="site-logo">
        <h1 class="site-title">love and share</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/https://yaogzblog.github.io/sharing.github.io/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            关于
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      分享我所热爱
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://yaogzblog.github.io/sharing.github.io//atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Principles of fMRI--Noise, Design and Pre-processing</h2>
            <div class="post-date">2020-07-20</div>
            
            <div class="post-content" v-pre>
              <h1 id="artifacts-and-noise">Artifacts and Noise</h1>
<p><strong>Sourse of noise</strong></p>
<ul>
<li>Thermal motion(热运动) of free electrons in system.</li>
<li>Gradient and magnetic field instability.</li>
<li>Head movement and its interactions with magnetic field.</li>
<li>physiological effects, including heart beat and respiration.</li>
</ul>
<p><strong>Appears in data as</strong></p>
<ul>
<li>High-frequency 'spikes'.</li>
<li>Image artifacts and distortions.</li>
<li>Low-frequency(slow) drift and periodic fluctuation over time .</li>
</ul>
<h1 id="noise-and-artifact-mitigation">Noise and artifact mitigation</h1>
<p><strong>Acquisition</strong></p>
<ul>
<li>Good quality control processess for scanner.</li>
<li>Choose acquisition sequence/parameters for your goal.</li>
<li>Specialized sequences(e.g., spin-echo, simultaneous multislice, Z-shimming).<br>
<strong>Analysis</strong></li>
<li>Look at data as it is acquired to check for issues.</li>
<li>Outlier/artifacts identification and correction .</li>
<li>Preprocessing to adjust for head motion drift.</li>
<li>Helpful statistical procedures(e.g., robust regression, hierarchical modeling).<br>
**Five issues you should check for and avoid **<br>
<img src="https://yaogzblog.github.io/sharing.github.io//post-images/1595226737958.png" alt="" loading="lazy"></li>
</ul>
<h1 id="drift">Drift</h1>
<ul>
<li>Slow changes in voxel intensity over time (low frequency nosie) is present in the fMRI signal.</li>
<li>Scanner instabilities are a main cause but aliased physiological is also important.<br>
We need to account for drift both in preprocessing and when calculate statistical analyses.<br>
<strong>Drift can have serious consequences</strong><br>
Experimental conditions that vary slowly may be confused with drift, so designs should use high frequencies (move rapid alternations of stimulus on/off state).</li>
</ul>
<h1 id="motion">Motion</h1>
<p>Typically motion correction is performed in the preprocessing stages of analysis. However, 'spin-history' artifacts may remain that can not be removed.</p>
<h1 id="physiological-noise">Physiological Noise</h1>
<p>Respiration and heart beat give rise to noise at particular frequencies. It can potentially be modeled in statistical analysis but if the TR is too low there will be problems with aliasing(信号错误识别).</p>
<h1 id="experimental-design">Experimental design</h1>
<p>**Goal **</p>
<ul>
<li>Induce human subject to do or experience the psychological states you are studying.</li>
<li>Effectively detect brain ssignal related to those psychological states.<br>
Block design: Similar events are group<br>
Event-related design: Events are mixed</li>
</ul>
<h1 id="pre-processing">Pre-processing</h1>
<p>aim at indentifying and removing artifacts and validating model assumptions.<br>
<strong>Goals</strong><br>
Tominimize the influence of data acquisition and physiological artifacts.<br>
To check statistical assumptions and transform the data to meet assumptions.<br>
To standarize the locations of brain regions arcoss subjects to achieve validity and sensitivity in group analysis.</p>
<h1 id="pipeline">Pipeline</h1>
<figure data-type="image" tabindex="1"><img src="https://yaogzblog.github.io/sharing.github.io//post-images/1595229786819.png" alt="" loading="lazy"></figure>
<h1 id="1-visualization-aritifact-removal">1 Visualization &amp; Aritifact Removal</h1>
<ul>
<li>To use exploratory techniques to investigate the raw image data and detect possible problems and artifacts.</li>
<li>fMRI data often contain transient spike artifacts and slow dirft over time, PCA can be used to look for spike -related artifacts.</li>
</ul>
<h1 id="2-slice-time-correction">2 Slice Time Correction</h1>
<p>We often sample multiple slices of the brain during each individual repetition time(TR)  to construct a brain volume.<br>
Typically each slice is sampled at a slightly different time point(2D,not 3D)<br>
Slice time correction shift each voxel's time series so that they all appear to have been sampled simultaneously.<br>
<strong>Methods</strong><br>
Temporal Interpolation. (use a linear, spline or sinc function)<br>
Phase shift: Fourier Transform</p>
<h1 id="3-head-motion">3 Head motion</h1>
<p>Head motion is a serious problem in neuroimaging. If we move head aroumd one voxel that was in this position might be in completely.<br>
It can be corrected using a rigid body transformation(刚体变换)<br>
The goal is to find the best possible alignment between an input image and some target image. To align the two images, one of them needs to be transformed. The target image is usually defined to be the first (or mean) image in the fMRI time series.<br>
<strong>Methods</strong><br>
Linear transformations<br>
Rigid boby(6DOF) - translation(x,y&amp;z) and rotation(pitch前后倾斜,yaw左右摇摆&amp;roll左右倾斜)<br>
Similarity(7DOF) - translation, rotation and a single global scaling<br>
Affine(12DOF) - translation, rotation, scaling and shearing</p>
<h1 id="4-coregistration">4 Coregistration</h1>
<p>A structural MRI collected in the begining of the session is registered to fMRI images in a process referred to as coregistration.</p>
<ul>
<li>Allows, one to visualize single-subject task activations overlaid on the individual's anotomical information.</li>
<li>Simplifies later transformation of the fMRI images to a standard coordinate system.</li>
</ul>
<h1 id="5-normalization">5 Normalization</h1>
<p>All brains are different, the brain size of two subjects can differ in size by uo to 30%. There may also be substantial variation in shapes of the brain.<br>
Normalization allows one to stretch, squeeze and warp each brain so that it is the same as some standard brain.<br>
<strong>Brain Atlases</strong><br>
Talairach space</p>
<ul>
<li>The origin(0,0,0) is set at the Anterior Commisure, the Anterior Commisure and Posterior Commisure is horizontal.<br>
Montreal Neurological Institute(MNI)<br>
<strong>Methods</strong></li>
<li>Landmark-based methods: Align anatomical feature in different brains</li>
<li>Volume-based registration: Linear(e.g., affine) and nonlinear transformations</li>
<li>Computational Anatomy: Diffeomorphic transformetion</li>
<li>Surface-based methods: work on cortical surfaces</li>
</ul>
<h1 id="6-spatial-filtering">6 Spatial Filtering</h1>
<ul>
<li>In fMRI, it is common to spatially smooth the acquired data prior to statistical analysis.</li>
<li>Can increase signal-to-noise, validate distributional assumptions and remove artifacts.<br>
When doing spatial filtering we often use a Gaussian Kernel and the size of the Kernel is determined by the full-width at half-maximum(FWHM), which measures the width of the Kernel at 50% of its peal value.</li>
</ul>

            </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://yaogzblog.github.io/sharing.github.io/post/principles-of-fmri/">
                  <h3 class="post-title">
                    Principles of fMRI--Basics
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>






  </body>
</html>
